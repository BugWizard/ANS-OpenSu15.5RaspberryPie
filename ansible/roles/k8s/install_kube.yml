---
- name: Install kubectl on OpenSUSE Leap 15
  hosts: OpenSUSE
  become: true
  tasks:

    - name: Install curl
      zypper:
        name: curl
        state: present

    - name: Download kubectl binary
      get_url:
        url: "https://storage.googleapis.com/kubernetes-release/release/$(curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt)/bin/linux/amd64/kubectl"
        dest: /usr/local/bin/kubectl
        mode: '0755'

    - name: Make kubectl binary executable
      file:
        path: /usr/local/bin/kubectl
        mode: '0755'

    - name: Verify kubectl version
      command: kubectl version --client
      register: result

    - name: Show kubectl version
      debug:
        var: result.stdout_lines
